---
title: "POS Tagging"
author: "Sarasati Palawita"
date: "28 December 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
```{r}
library (NLP)

library (openNLPmodels.en)
library (tm)
library (stringr)
library (gsubfn)
library (plyr)
library (corpus)
library(dplyr)
library(tidytext)
library(stringr)
library(e1071)
library(ggplot2)
library(tibble)
library (tm)
library("corpus")
library (OpenNLP)
install.packages("rJava", type = "source")
install.packages("rJava", type = "source")
install.packages("openNLP", type="source") 
library('openNLP')
require(rJava)
require(openNLP)
R.Version()
if (Sys.getenv("JAVA_HOME")!="")
  Sys.setenv(JAVA_HOME="")
library(rJava)

install.packages("rJava")

.rs.restartR()



```
Read suto paragraphs

```{r}
#textdata <- read.csv("data/sotu_paragraphs.csv", sep = ";", encoding = "UTF-8")
#english_stopwords <- readLines("resources/stopwords_en.txt", encoding = "UTF-8")
lyrics = read.csv("C:/Users/Sarasati Palawita/Documents/Personal/BIPM 2017/Master Thesis 2018/Data/test.csv")
lyrics$lyrics <- as.character(lyrics$lyrics)
lyrics <- as_tibble(lyrics)
class(lyrics)
lyrics$text <- lyrics$lyrics

dat <- data.frame(lyrics)
as_corpus_frame(dat)

```
```{r}
# Create corpus object
#corpus <- Corpus(DataframeSource(textdata))

#require(openNLP)
#require(openNLPdata)
library (openNLPdata)
library(openNLP)
# openNLP annotator objects
sent_token_annotator <- Maxent_Sent_Token_Annotator()
word_token_annotator <- Maxent_Word_Token_Annotator()
pos_tag_annotator <- Maxent_POS_Tag_Annotator()
annotator_pipeline <- Annotator_Pipeline(
  sent_token_annotator,
  word_token_annotator,
  pos_tag_annotator
)

# function for annotation
annotateDocuments <- function(doc, pos_filter = NULL) {
  doc <- as.String(doc)
  doc_with_annotations <- annotate(doc, annotator_pipeline)
  tags <- sapply(subset(doc_with_annotations, type=="word")$features, `[[`, "POS")
  tokens <- doc[subset(doc_with_annotations, type=="word")]
  if (!is.null(pos_filter)) {
    res <- tokens[tags %in% pos_filter]
  } else {
    res <- paste0(tokens, "_", tags)
  }
  res <- paste(res, collapse = " ")
  return(res)
}

# run annotation on a sample of the corpus
annotated_corpus <- lapply(corpus[1:10], annotateDocuments)

# Have a look into the first annotated documents
annotated_corpus[[1]]
annotated_corpus[[2]]
```

